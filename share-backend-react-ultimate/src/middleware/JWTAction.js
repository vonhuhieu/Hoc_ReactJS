'use strict';var _0x1ee18a=_0x1cc4;function _0x3305(){var _0x43e2bf=['cookies','2803800OiOAAR','251200Wmikcx','JWT\x20Token\x20đã\x20hết\x20hạn.\x20Bạn\x20cần\x20dùng\x20Refresh_Token\x20để\x20lấy\x20token\x20mới,\x20or\x20Login\x20lại\x20và\x20sử\x20dụng\x20Access_Token\x20mới\x20:v','10122BBBTzj','/logout','some','1321385pyyGrL','../models/index','[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?','3391848XedNIn','path','headers','body','8511584NbCfCD','Bearer','config','split','/login','TokenExpiredError','delay','JWT_SECRET','default','/participant/all','Roles','/participant','user','authorization','/register','url','access_token','dotenv','status','groupWithRoles','fKSJm','uuid','678bTxnBL','jsonwebtoken','bcryptjs','31161zzuvta','you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...','/refresh-token','verify','lodash','__esModule','json'];_0x3305=function(){return _0x43e2bf;};return _0x3305();}(function(_0x27072e,_0x279d51){var _0x22a120=_0x1cc4,_0xfdbb46=_0x27072e();while(!![]){try{var _0x94ffb3=parseInt(_0x22a120(0x119))/0x1+-parseInt(_0x22a120(0x122))/0x2+parseInt(_0x22a120(0x121))/0x3+parseInt(_0x22a120(0xfc))/0x4+-parseInt(_0x22a120(0x127))/0x5+-parseInt(_0x22a120(0x116))/0x6*(-parseInt(_0x22a120(0x124))/0x7)+-parseInt(_0x22a120(0x100))/0x8;if(_0x94ffb3===_0x279d51)break;else _0xfdbb46['push'](_0xfdbb46['shift']());}catch(_0x57ee2b){_0xfdbb46['push'](_0xfdbb46['shift']());}}}(_0x3305,0x7fc20));var _jsonwebtoken=_interopRequireDefault(require(_0x1ee18a(0x117))),_lodash=require(_0x1ee18a(0x11d)),_uuid=require(_0x1ee18a(0x115)),_index=_interopRequireDefault(require(_0x1ee18a(0xfa))),_bcryptjs=_interopRequireDefault(require(_0x1ee18a(0x118)));function _interopRequireDefault(_0x5ddfbb){var _0x29d6ba=_0x1ee18a;return _0x5ddfbb&&_0x5ddfbb[_0x29d6ba(0x11e)]?_0x5ddfbb:{'default':_0x5ddfbb};}require(_0x1ee18a(0x111))[_0x1ee18a(0x102)]();var nonSecurePaths=[_0x1ee18a(0x125),_0x1ee18a(0x104),_0x1ee18a(0x10e),_0x1ee18a(0x11b),_0x1ee18a(0x10b),_0x1ee18a(0x109)],verifyToken=function(_0x3fa171){var _0x3eb5cb=_0x1ee18a,_0x11fc36=process['env'][_0x3eb5cb(0x107)],_0x1874d6=null;try{_0x1874d6=_jsonwebtoken[_0x3eb5cb(0x108)][_0x3eb5cb(0x11c)](_0x3fa171,_0x11fc36);}catch(_0x51568f){if(_0x51568f instanceof _jsonwebtoken['default']['TokenExpiredError'])return _0x3eb5cb(0x105);}return _0x1874d6;},extractToken=function(_0x163e3e){var _0x2a79d6=_0x1ee18a;return _0x163e3e[_0x2a79d6(0xfe)][_0x2a79d6(0x10d)]&&_0x2a79d6(0x101)===_0x163e3e[_0x2a79d6(0xfe)][_0x2a79d6(0x10d)][_0x2a79d6(0x103)]('\x20')[0x0]?_0x163e3e['headers'][_0x2a79d6(0x10d)][_0x2a79d6(0x103)]('\x20')[0x1]:null;},checkUserJWT=function(_0x22130b,_0x14be2f,_0x7ef0ff){var _0x236ea6=_0x1ee18a;if(nonSecurePaths['includes'](_0x22130b[_0x236ea6(0xfd)]))return _0x7ef0ff();var _0xdedd50=_0x22130b[_0x236ea6(0x120)],_0x1e23fb=extractToken(_0x22130b);return _0xdedd50&&_0xdedd50[_0x236ea6(0x110)]||_0x1e23fb?(_0xdedd50=_0xdedd50&&_0xdedd50['access_token']?_0xdedd50['access_token']:_0x1e23fb,(_0x1e23fb=verifyToken(_0xdedd50))&&_0x236ea6(0x105)!==_0x1e23fb?(_0x22130b[_0x236ea6(0x10c)]=_0x1e23fb,void _0x7ef0ff()):_0x1e23fb&&_0x236ea6(0x105)===_0x1e23fb?_0x14be2f[_0x236ea6(0x112)](0x195)[_0x236ea6(0x11f)]({'EC':-0x3e7,'DT':'','EM':_0x236ea6(0x123)}):_0x14be2f[_0x236ea6(0x112)](0x191)[_0x236ea6(0x11f)]({'EC':-0x1,'DT':'','EM':_0x236ea6(0xfb)})):_0x14be2f[_0x236ea6(0x112)](0x191)[_0x236ea6(0x11f)]({'EC':-0x1,'DT':'','EM':_0x236ea6(0xfb)});},checkUserPermission=function(_0x32f052,_0x4d0c4b,_0x67ae5f){var _0x5dc9a7=_0x1ee18a;return nonSecurePaths['includes'](_0x32f052['path'])||'/account'===_0x32f052['path']?_0x67ae5f():_0x32f052[_0x5dc9a7(0x10c)]?(_0x32f052[_0x5dc9a7(0x10c)]['email'],_0x44e8ab=_0x32f052[_0x5dc9a7(0x10c)][_0x5dc9a7(0x113)][_0x5dc9a7(0x10a)],_0xe43f1e=_0x32f052[_0x5dc9a7(0xfd)],!_0x44e8ab||0x0===_0x44e8ab['length']||!0x0!==_0x44e8ab[_0x5dc9a7(0x126)](function(_0x220437){var _0x95c8b=_0x5dc9a7;if(_0x95c8b(0x114)!=='cOCei')return _0x220437[_0x95c8b(0x10f)]===_0xe43f1e||_0xe43f1e['includes'](_0x220437['url']);else{if(_0x31b0cc['includes'](_0x6e00f2[_0x95c8b(0xfd)]))return _0x4d915e();var _0x57339a=_0x23fdee['cookies'],_0x31b461=_0x3db685(_0x43a71e);return _0x57339a&&_0x57339a[_0x95c8b(0x110)]||_0x31b461?(_0x57339a=_0x57339a&&_0x57339a['access_token']?_0x57339a['access_token']:_0x31b461,(_0x31b461=_0x1e2437(_0x57339a))&&_0x95c8b(0x105)!==_0x31b461?(_0x231a3b[_0x95c8b(0x10c)]=_0x31b461,void _0x2aa7f4()):_0x31b461&&'TokenExpiredError'===_0x31b461?_0x19ace1[_0x95c8b(0x112)](0x195)['json']({'EC':-0x3e7,'DT':'','EM':_0x95c8b(0x123)}):_0x20937a[_0x95c8b(0x112)](0x191)[_0x95c8b(0x11f)]({'EC':-0x1,'DT':'','EM':_0x95c8b(0xfb)})):_0x4ed8bc[_0x95c8b(0x112)](0x191)[_0x95c8b(0x11f)]({'EC':-0x1,'DT':'','EM':_0x95c8b(0xfb)});}})?_0x4d0c4b['status'](0x193)['json']({'EC':-0x1,'DT':'','EM':_0x5dc9a7(0x11a)}):void _0x67ae5f()):_0x4d0c4b[_0x5dc9a7(0x112)](0x191)[_0x5dc9a7(0x11f)]({'EC':-0x1,'DT':'','EM':_0x5dc9a7(0xfb)});var _0x44e8ab,_0xe43f1e;},addDelay=function(_0x301f31,_0x161e64,_0x2147b6){var _0x4c599b=_0x1ee18a,_0x787d60;null!=_0x301f31&&null!=(_0x787d60=_0x301f31['body'])&&_0x787d60[_0x4c599b(0x106)]&&+(null==_0x301f31||null==(_0x787d60=_0x301f31[_0x4c599b(0xff)])?void 0x0:_0x787d60[_0x4c599b(0x106)])?setTimeout(function(){_0x2147b6();},+_0x301f31['body']['delay']):_0x2147b6();};function _0x1cc4(_0x526192,_0x23330e){var _0x3305e2=_0x3305();return _0x1cc4=function(_0x1cc4e1,_0x3a3bf2){_0x1cc4e1=_0x1cc4e1-0xfa;var _0x4c7d30=_0x3305e2[_0x1cc4e1];return _0x4c7d30;},_0x1cc4(_0x526192,_0x23330e);}module['exports']={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};